<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"> <!-- For proper character encoding -->
        <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- To render according to device width -->
        <title>Home</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    </head>
    <body>
        <!-- searching movie -->
        <!-- <h1 id="main">Home</h1>
        <% if(username !== '') { %>
            <h2>Hello, <%= username %></h2>
        <% } %>

        <a style="color: blue;" href="<%= username === '' ? '/ratings' : '/userRatings?username=' + username %>">Reviews</a>
        <a style="color: blue;" href="<%= username === '' ? '/signup' : '/signup?username=' + username %>">Sign Up</a>
        <a style="color: blue;" href="<%= username === '' ? '/login' : '/login?username=' + username %>">Login</a>
        <% if(username !== '') { %>
            <a style="color: blue;" href="/">Logout</a>
        <% } %> -->

        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <div class="navbar-header">
                    <!-- Open's the collapsed NavBar -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>                        
                    </button>
                    <a class="navbar-brand" href="<%= username ? '/?username=' + username : '/' %>">CS108</a>
                </div>
                
                <!-- All of the further NavBar things should collapse when screen size is small-->
                
                <div class="collapse navbar-collapse" id="myNavbar">
                    <!-- Left Navigation Bar -->
                    <ul class="nav navbar-nav navbar-left">
                        <li class="active"><a href="<%= username ? '/?username=' + username : '/' %>">Home</a></li>
                        <li><a href="<%= username === '' ? '/ratings' : '/userRatings?username=' + username %>">Ratings</a></li>
                    </ul>
                    
                    <!-- Search Bar -->
    
                    <form class="navbar-form navbar-left" action="<%= username !== '' ? '/submit?username=' + username : '/submit' %>" method="post">
                        <div class="input-group">
                            <input type="text" class="form-control" name="movieName" placeholder="Search Movies">
                            <div class="input-group-btn">
                                <button class="btn btn-default" type="submit">
                                    <i class="glyphicon glyphicon-search"></i>
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Right Navigation Bar -->
                    <ul class="nav navbar-nav navbar-right">
                        <% if(username !== '') { %>
                            <p class="navbar-text">Hi, <%= username %> </p>
                        <% } %>
                        <li><a href="<%= username === '' ? '/signup' : '/signup?username=' + username %>"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                        <li><a href="<%= username === '' ? '/login' : '/login?username=' + username %>"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                        <% if(username !== '') { %>
                            <li><a href="/"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
                        <% } %> 
                    </ul>
                </div>
            </div>
        </nav>


        <!-- displaying movie info -->
        <%if(movies.length > 0 && movies[movies.length-1].Title != 'Movie Not Found'){ %>
            <ul>
                <h2>Movie Info:</h2>
                <% currentMovie = movies[movies.length -1] %>
                 <li>Title: <%= currentMovie.Title %> </li>
                 <li>Year Released: <%= currentMovie.Year_Released %></li>
                 <li>Duration: <%= currentMovie.Duration %></li>
                 <li>Rating: <%= currentMovie.Rating %></li>
                <% if(userRating === '') { %>
                    <li>No one rated till now!</li>
                <% } else { %>
                    <li>Rating by our users: <%= userRating %></li>
                <% } %>
                 <li>Genre: <%= currentMovie.Genres.join(", ") %></li>
                 <li>Plot: <%= currentMovie.Plots %></li>
                 <li>Director: <%= currentMovie.Directors.join(", "); %></li>
                 <li>Casts: <%= currentMovie.Casts.join(", ") %></li>
                 <li><a style="color: blue;" href="<%= currentMovie.Trailer_Links%>" >Trailer</a></li>
                <% if(currentMovie.Streaming_Platforms[0].length > 0) { %>
                    <li>Streaming Platforms:
                        <ul>
                            <% for(let i=0; i<currentMovie.Streaming_Platforms[0].length; i++) { %>
                                <li><a style="color: blue;" href="<%= currentMovie.Streaming_Platforms[1][i] %>"><%= currentMovie.Streaming_Platforms[0][i] %></a></li>
                            <% } %>
                        </ul>
                    </li>
                <% } %>
                <% if(currentMovie.Other_Ratings[0].length > 0) { %>
                    <li>Other Ratings:
                        <ul>
                            <% for(let i=0; i<currentMovie.Other_Ratings[0].length; i++) { %>
                                <li><a style="color: blue;" href="<%= currentMovie.Other_Ratings[2][i] %>"><%= currentMovie.Other_Ratings[1][i] %></a>: <%= currentMovie.Other_Ratings[0][i] %></li>
                            <% } %>
                        </ul>
                    </li>
                <% } %>
            </ul>
            <% if(currentMovie.Image) { %>
                <img id="Image" width="200px" src="<%= currentMovie.Image %>" alt="Movie Image">
            <% } %>
            <% if(outSideReviews.RottenTomatoes != undefined && outSideReviews.RottenTomatoes.length > 0){ %>
                <h2>Reviews from Rotten Tomatoes</h2>
                <ul>
                    <% for(let i=0; i<outSideReviews.RottenTomatoes.length; i++) { %> 
                        <li><a style="color: blue" href="<%= outSideReviews.RottenTomatoes[i][1] %>"><%= outSideReviews.RottenTomatoes[i][0] %></a>: <%= outSideReviews.RottenTomatoes[i][2] %></li>
                    <% } %>
                </ul>
            <% } %>
        <% } else if (movies.length == 0) { %>
        <% } else if (searchSuggestions.length > 0) { %>
            <h2>Did you mean these?</h2>
            <ul>
                <% for(let i=0; i<searchSuggestions.length; i++) { %>
                    <li><a style="color: blue;" href="/submit?movieName=<%= searchSuggestions[i].Title %>&username=<%=username%>"><%= searchSuggestions[i].Title %></a></li>
                <% } %>
            </ul>
        <% } %>

    </body>
</html>